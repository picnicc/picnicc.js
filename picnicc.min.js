/**
 * picnicc.js v1.0.0
 * @author Alex Duloz ~ @alexduloz ~ http://bitspushedaround.com/
 * MIT license
 */
(function(e){e.document,blueprint={_:function(){return this}},blueprint._(),e.picnicc=blueprint})(window),function(e){e.document;var i=blueprint={_:function(){return this._retrieveEndpoint="https://picni.cc/api/v1/retrieve/",this._transmitEndpoint="https://picni.cc/api/v1/build/",this._buildForm="picnicc",this._buildIdField="picnicc_build_id",this._buildIdSubmit="picnicc_retrieve_build",this},setBuildForm:function(e){return i._buildForm=e,this},getBuildForm:function(){return i._buildForm},setBuildIdField:function(e){return i._buildIdField=e,this},getBuildIdField:function(){return i._buildIdField},setBuildIdSubmit:function(e){return i._buildIdSubmit=e,this},getBuildIdSubmit:function(){return i._buildIdSubmit},topicalize:function(e){e&&(i._buildForm=e.setBuildForm||i._buildForm,i._buildIdField=e.setBuildIdField||i._buildIdField,i._buildIdSubmit=e.setBuildIdSubmit||i._buildIdSubmit)},reset:function(){i._()}};blueprint._(),picnicc.config=blueprint}(window),function(e){var i=e.document;blueprint={_:function(){return this},$:function(t){if(!t)return i.querySelector||e.jQuery;if(i.querySelector)return i.querySelector(t);if(e.jQuery){var n=e.jQuery(t);if(n.length>0)return n.get(0)}return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},serialize:function(e){for(var i="",t=e.elements,n=t.length,c=0;n>c;c++)t[c]&&""!==t[c].name&&("checkbox"!==t[c].type||t[c].checked===!0)&&(i+="&"+t[c].name+"="+t[c].value);return i=i.substr(1)}},blueprint._(),picnicc.utility=blueprint}(window),function(e){e.document;var i=blueprint={_:function(){return this._response,this._responseParsed,this._code,this},createXhr:function(){try{return new XMLHttpRequest}catch(e){console.error(e)}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){console.error(e)}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){console.error(e)}},request:function(e,t,n,c,r){i._code=!1,i._response=!1,i._responseParsed=!1;var r=r!==void 0?!1:!0;(picnicc.utility.isObject(n)||picnicc.utility.isArray(n))&&(n=picnicc.utility.serialize(n));var l=i.createXhr();return l.onreadystatechange=function(){if(4==l.readyState){i._code=l.status,i._response=l.responseText;try{i._responseParsed=JSON.parse(i._response)}catch(e){console.error(e)}c(l.status,l.responseText)}},"GET"===e&&(l.open("GET",t+"?"+n,r),l.send(null)),"POST"===e&&(l.open("POST",t,r),l.send(n)),"DELETE"===e&&(l.open("DELETE",t+"?"+n,r),l.send(null)),this},response:function(e){return e===!0?i._responseParsed:i._response},code:function(){return i._code}};blueprint._(),picnicc.xhr=blueprint}(window),function(e){var i=e.document,t=blueprint={_:function(){return t._callbacks={},this._mode,this._response,this._error,this._currentForm,this._currentBuildIdField,this._currentBuildIdSubmit,this._currentFields,this._enabled,this},init:function(){var e=t.setBuildForm(picnicc.config.getBuildForm()).getBuildForm();if(!e)return this;t.transmitEventListener(e),t.enable(e);var i=t.setBuildIdField(picnicc.config.getBuildIdField()).getBuildIdField(),n=t.setBuildIdSubmit(picnicc.config.getBuildIdSubmit()).getBuildIdSubmit();return i&&n&&t.retrieveEventListener(e,i,n),this},setBuildForm:function(e){var n;return n||(n=picnicc.utility.$(e)),n||(n=i.forms[e]),n||(n=i.getElementById(e)),n||(n=i.getElementsByClassName(e)[0]),n||(n=picnicc.utility.$(e)),t._currentForm=n,this},getBuildForm:function(){return t._currentForm},setBuildIdField:function(e){if(!t.getBuildForm())return this;var n;return n||(n=picnicc.utility.$(e)),n||(n=i.getElementById(e)),n||(n=t.findName(e,t.getBuildForm().elements)),n||(n=i.getElementsByClassName(e)[0]),t._currentBuildIdField=n,this},getBuildIdField:function(){return t._currentBuildIdField},setBuildIdSubmit:function(e){if(!t.getBuildForm())return this;var n;return n||(n=picnicc.utility.$(e)),n||(n=i.getElementById(e)),n||(n=t.findName(e,t.getBuildForm().elements)),n||(n=i.getElementsByClassName(e)[0]),t._currentBuildIdSubmit=n,this},getBuildIdSubmit:function(){return t._currentBuildIdSubmit},findName:function(e,i){for(var t=i.length,n=0;t>n;n++)if(i[n].name===e)return i[n];return!1},enabled:function(){return t._enabled},disable:function(){t._enabled=!1},enable:function(e){t._enabled=!0;var i,n;i=t.findName("if_success",e.elements),n=t.findName("if_error",e.elements),i&&(i.value="200"),n&&n.parentNode.removeChild(n)},retrieveEventListener:function(e,i,n,c){var r=e.elements;t._currentFields=r;var l=r.length,s=function(i){i.preventDefault(),t._callbacks[e]&&t._callbacks[e][c]&&t._callbacks[e][c].begins&&picnicc.utility.isFunction(t._callbacks[e][c].begins)&&t._callbacks[e][c].begins();var n=picnicc.utility.serialize(e).replace(picnicc.config.getBuildIdField(),"id");return picnicc.xhr.request("GET",picnicc.config._retrieveEndpoint,n,function(i,n){var s=picnicc.xhr.response(!0);if(422===i){var u={};if(u.raw=n,u.parsed=s,u.code=i,u.message=s.message,u.label=s.label,t._error=u,!(t._callbacks[e]&&t._callbacks[e][c]&&t._callbacks[e][c].fail&&picnicc.utility.isFunction(t._callbacks[e][c].fail)))return alert(u.message),void 0;t._callbacks[e][c].fail(u)}if(200===i){var a={};if(a.raw=n,a.parsed=s,a.code=i,a.version=s.version,a.assets=s.assets,a.bits=s.bits,a.behavior=s.behavior,a.parse=s.parse,a.minify=s.minify,t._response=a,t._callbacks[e]&&t._callbacks[e][c]&&t._callbacks[e][c].done&&picnicc.utility.isFunction(t._callbacks[e][c].done))t._callbacks[e][c].done(a);else for(var o=0;l>o;o++)r[o]&&-1!==s.bits.indexOf(r[o].value)&&(r[o].checked=!0)}t._callbacks[e]&&t._callbacks[e][c]&&t._callbacks[e][c].ends&&picnicc.utility.isFunction(t._callbacks[e][c].ends)&&t._callbacks[e][c].ends()}),!1};return n.addEventListener("click",s),this},whenRetrieve:function(e){t._mode="retrieve",picnicc.config.topicalize(e);var i=t.setBuildForm(picnicc.config.getBuildForm()).getBuildForm();if(!i)return t.disable(),this;var n=t.setBuildIdField(picnicc.config.getBuildIdField()).getBuildIdField();if(!n)return t.disable(),this;var c=t.setBuildIdSubmit(picnicc.config.getBuildIdSubmit()).getBuildIdSubmit();return c?(t.retrieveEventListener(i,n,c,t._mode),t.enable(i),t._callbacks[i]||(t._callbacks[i]={}),t._callbacks[i][t._mode]={},picnicc.config.reset(),this):(t.disable(),this)},transmitEventListener:function(i,n){var c=function(c){return c.preventDefault(),t._callbacks[i]&&t._callbacks[i][n]&&t._callbacks[i][n].begins&&picnicc.utility.isFunction(t._callbacks[i][n].begins)&&t._callbacks[i][n].begins(),picnicc.xhr.request("GET",picnicc.config._transmitEndpoint,picnicc.utility.serialize(i),function(c,r){var l=picnicc.xhr.response(!0);if(422===c){var s={};if(s.raw=r,s.parsed=l,s.code=c,s.message=l.message,s.label=l.label,t._error=s,!(t._callbacks[i]&&t._callbacks[i][n]&&t._callbacks[i][n].fail&&picnicc.utility.isFunction(t._callbacks[i][n].fail)))return alert(s.message),void 0;t._callbacks[i][n].fail(s)}if(200===c){var u={};if(u.raw=r,u.parsed=l,u.code=c,u.location=l.location,u.status=l.status,t._response=u,!(t._callbacks[i]&&t._callbacks[i][n]&&t._callbacks[i][n].done&&picnicc.utility.isFunction(t._callbacks[i][n].done)))return e.location.href=u.location,void 0;t._callbacks[i][n].done(u)}t._callbacks[i]&&t._callbacks[i][n]&&t._callbacks[i][n].ends&&picnicc.utility.isFunction(t._callbacks[i][n].ends)&&t._callbacks[i][n].ends()}),!1};return i.addEventListener("submit",c),this},whenTransmit:function(e){t._mode="transmit",picnicc.config.topicalize(e);var i=t.setBuildForm(picnicc.config.getBuildForm()).getBuildForm();return i?(t.transmitEventListener(i,t._mode),t.enable(i),t._callbacks[i]||(t._callbacks[i]={}),t._callbacks[i][t._mode]={},picnicc.config.reset(),this):(t.disable(),this)},begins:function(e){return t.enabled()?(t._callbacks[t.getBuildForm()][t._mode].begins=e,this):this},done:function(e){return t.enabled()?(t._callbacks[t.getBuildForm()][t._mode].done=e,this):this},fail:function(e){return t.enabled()?(t._callbacks[t.getBuildForm()][t._mode].fail=e,this):this},ends:function(e){return t.enabled()?(t._callbacks[t.getBuildForm()][t._mode].ends=e,this):this},response:function(){return t._response},error:function(){return t._error},checkboxify:function(e,i){if(i||(i=t._currentFields),!i)return this;for(var n=i.length,c=0;n>c;c++)-1!==e.indexOf(i[c].value)&&(i[c].checked=!0);return this}};blueprint._(),picnicc.form=blueprint}(window);